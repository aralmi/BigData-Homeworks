# Домашнее задание 4: Рекомендательные системы и Spark MLlib

## Описание

Реализация и сравнение трёх методов предсказания рейтингов фильмов используя датасет **MovieLens**.

## Данные

- **Размер:** 100,836 рейтингов
- **Фильмов:** 9,742
- **Пользователей:** ~600 (примерно)
- **Жанры (вариант):** Animation, Romance, Documentary
- **Рейтинги:** Целые числа от 0.5 до 5.0

## Три метода предсказания

### 1 Базовая модель (Baseline)
```
Метод:   Всегда предсказываем среднее значение
Формула: pred = mean(train_ratings) = 3.5039
RMSE:    1.0504
```

### 2 Коллаборативная фильтрация (User-Based CF)
```
Метод:   Усреднение рейтингов пользователя и фильма
Формула: pred = (user_avg + item_avg) / 2
         (если данные есть, иначе используем резервное значение)
RMSE:    0.8986
Улучшение: +14.45%
```

### 3 Факторизация матриц (ALS - Alternating Least Squares)
```
Метод:   Декомпозиция матрицы рейтингов на два вектора
         User Factor × Item Factor ≈ Rating Matrix
         
Параметры подобраны через 4-fold кросс-валидацию:
- rank = 5 (размер латентного пространства)
- regParam = 0.1 (коэффициент регуляризации)
- maxIter = 10 (итерации оптимизации)

RMSE:    0.8755
Улучшение: +16.65%
```

## Результаты по жанрам

### Animation (611 фильмов)

**ТОП-5 по количеству рейтингов:**
1. Toy Story (1995) - 215 рейтингов
2. Aladdin (1992) - 183 рейтингов
3. Lion King, The (1994) - 172 рейтингов
4. Shrek (2001) - 170 рейтингов
5. Beauty and the Beast (1991) - 146 рейтингов

**Лучшие по рейтингу (среди популярных >10 оценок):**
1. Creature Comforts (1989) - 4.25⭐
2. Persepolis (2007) - 4.18⭐
3. Grave of the Fireflies (1988) - 4.16⭐
4. Spirited Away (2001) - 4.16⭐
5. Ghost in the Shell (1995) - 4.15⭐

**Худшие по рейтингу:**
1. Shark Tale (2004) - 2.35⭐ (13 оценок)
2. Ice Age: Dawn of the Dinosaurs (2009) - 2.61⭐
3. Happy Feet (2006) - 2.68⭐
4. All Dogs Go to Heaven (1989) - 2.70⭐
5. Space Jam (1996) - 2.71⭐

### Romance (1,596 фильмов)

**ТОП-5 по количеству рейтингов:**
1. Forrest Gump (1994) - 329 рейтингов
2. American Beauty (1999) - 204 рейтингов
3. True Lies (1994) - 178 рейтингов
4. Speed (1994) - 171 рейтингов
5. Shrek (2001) - 170 рейтингов

**Лучшие классические:**
1. His Girl Friday (1940) - 4.39⭐
2. Sunset Boulevard (1950) - 4.33⭐
3. It Happened One Night (1934) - 4.32⭐
4. Philadelphia Story (1940) - 4.31⭐
5. Harold and Maude (1971) - 4.29⭐

**Худшие:**
1. Speed 2: Cruise Control (1997) - 1.61⭐ (38 оценок) 
2. Grease 2 (1982) - 2.08⭐
3. Bewitched (2005) - 2.27⭐
4. Next Karate Kid (1994) - 2.37⭐
5. Joe Dirt (2001) - 2.38⭐

### Documentary (440 фильмов)

**ТОП-5 по количеству рейтингов:**
1. Bowling for Columbine (2002) - 58 рейтингов
2. Super Size Me (2004) - 50 рейтингов
3. Fahrenheit 9/11 (2004) - 37 рейтингов
4. Roger & Me (1989) - 31 рейтингов
5. Hoop Dreams (1994) - 29 рейтингов

**Лучшие документальные:**
1. Fog of War (2003) - 4.31⭐
2. Hoop Dreams (1994) - 4.29⭐
3. Inside Job (2010) - 4.29⭐
4. Crumb (1994) - 4.21⭐
5. Exit Through the Gift Shop (2010) - 4.04⭐

**Худшие:**
1. Fahrenheit 9/11 (2004) - 3.49⭐
2. Jackass: The Movie (2002) - 3.50⭐
3. Super Size Me (2004) - 3.51⭐
4. March of the Penguins (2005) - 3.56⭐

## Сравнение методов

| Показатель | Baseline | CF | ALS |
|-----------|----------|----|----|
| **RMSE** | 1.0504 | 0.8986 | 0.8755 |
| **Улучшение** | - | +14.45% | +16.65% |
| **Сложность** | ⭐ | ⭐⭐ | ⭐⭐⭐ |
| **Память** | O(1) | O(n+m) | O(rank × (n+m)) |
| **Скорость обучения** | моментальная | секунды | минуты |

## Почему ALS лучше?

1. **Латентные факторы:** Находит скрытые причины сходства между пользователями и фильмами
2. **Нелинейность:** Может моделировать сложные взаимодействия
3. **Масштабируемость:** Работает с разреженными матрицами (большинство рейтингов отсутствуют)
4. **Параметры:** Хорошо настраивается через cross-validation

